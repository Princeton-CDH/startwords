var hideOnScroll=true;document.addEventListener('DOMContentLoaded',function(){disableHideOnScroll(2)
positionContextualNote();},false);window.addEventListener('hashchange',function(){positionContextualNote();},false);window.addEventListener('scroll',function(e){if(location.hash.startsWith('#fn:')&&hideOnScroll){location.hash='';}});function disableHideOnScroll(seconds){hideOnScroll=false;window.setTimeout(function(){hideOnScroll=true;},seconds*1000);}
function positionContextualNote(){let mql=window.matchMedia('(min-width: 500px)');if(!mql.matches){return;}
if(location.hash.startsWith('#fn:')){var noteId=location.hash.slice(1);}else{return;}
var note=document.getElementById(noteId);var backref=note.getElementsByClassName('footnote-backref').item(0);var ref=document.getElementById(backref.getAttribute('href').slice(1));var refLocation=ref.getBoundingClientRect();var noteTop=refLocation.top+refLocation.height+5+'px';note.style.top=refLocation.top+refLocation.height+5+'px';var noteLeft;if(refLocation.left<(note.clientWidth-70)){noteLeft=refLocation.left+refLocation.width/2-70;note.classList.add('flip');}else{noteLeft=refLocation.left+refLocation.width/2-note.clientWidth+70;}
note.style.left=noteLeft+'px'
note.style.bottom='auto';var noteLocation=note.getBoundingClientRect();if(noteLocation.bottom>window.innerHeight){disableHideOnScroll(2)
var adjustment=noteLocation.bottom-window.innerHeight+10;window.scrollBy(0,adjustment);note.style.top=noteLocation.top-adjustment+'px';}}