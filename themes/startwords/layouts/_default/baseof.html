<!DOCTYPE html>
<html lang="en-us">
<head>
    <!-- metadata -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    {{ $favicon_path := "/img/favicon" | relURL}}
    <link rel="apple-touch-icon" sizes="180x180" href="{{ $favicon_path }}/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="{{ $favicon_path }}/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="{{ $favicon_path }}/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="384x384" href="{{ $favicon_path }}/android-chrome-384x384.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="{{ $favicon_path }}/android-chrome-192x192.png" />
    <link rel="icon" type="image/png" sizes="150x150" href="{{ $favicon_path }}/mstile-150x150.png" />
    <link rel="shortcut icon" href="{{ $favicon_path }}/favicon.ico" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="{{ $favicon_path }}/safari-pinned-tab.svg" color="#CE2949" />
    <meta name="theme-color" content="#ff0000" />

    <title>{{ .Title }}</title>
    {{ with .Site.Params.description }}<meta name="description" content="{{ . }}">{{ end }}
    {{ with .Site.Params.author }}<meta name="author" content="{{ . }}">{{ end }}
    {{ template "_internal/opengraph.html" . }}
    {{ template "_internal/twitter_cards.html" . }}

    <!-- styles -->
    {{ $styleOptions := (dict "targetPath" "style.css" "outputStyle" "compressed" "enableSourcemap" true) }}
    {{ $printOptions := (dict "targetPath" "print.css" "outputStyle" "compressed" "enableSourcemap" true) }}
    {{ $style := resources.Get "scss/main.scss" | resources.ToCSS $styleOptions }}
    {{ $print := resources.Get "scss/print.scss" | resources.ToCSS $printOptions }}
    <link rel="stylesheet" href="{{ $style.RelPermalink }}">
    <link rel="stylesheet" href="{{ $print.RelPermalink }}" media="print">
    {{ block "css" . }}{{ end }}

    {{ $vendor := resources.Get "js/vendor.js" }}
    <script type="text/javascript" src="{{ $vendor.RelPermalink }}"></script>
    {{ $issue := resources.Get "js/issue.js" }}
    {{ $notes := resources.Get "js/notes.js" }}
    {{ $nav := resources.Get "js/nav.js" }}
    {{ $js := slice $notes $nav $issue | resources.Concat "js/bundle.js" | resources.Minify}}
    <script type="text/javascript" src="{{ $js.RelPermalink }}"></script>
    {{ template "_internal/google_analytics_async.html" . }}
    <!-- alternative formats -->
    {{ range .AlternativeOutputFormats -}}
    <link rel="{{ .Rel }}" type="{{ .MediaType.Type }}" href="{{ .Permalink | safeURL }}">
    {{ end -}}

    {{ block "page_meta" . }}{{ end }}

    {{ if .HasShortcode "deepzoom" }}{{/* include openseadragon when deepzoom shortcode is used */}}
    <script src="https://cdn.jsdelivr.net/npm/openseadragon@2.4.2/build/openseadragon/openseadragon.min.js" integrity="sha256-NMxPj6Qf1CWCzNQfKoFU8Jx18ToY4OWgnUO1cJWTWuw=" crossorigin="anonymous"></script>
    {{ end }}

</head>
<body class="{{ block `pagetype` . }}{{ end }}">
    {{ partial "header" . }}
    {{ block "main" . }}{{ end }}
    {{ partial "footer" . }}
</body>
</html>
